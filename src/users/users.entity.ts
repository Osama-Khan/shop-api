import { Product } from 'src/products/products.entity';
import { Address } from 'src/address/address.entity';
import { Role } from 'src/roles/roles.entity';
import {
  Entity,
  Column,
  PrimaryGeneratedColumn,
  CreateDateColumn,
  UpdateDateColumn,
  OneToMany,
  ManyToMany,
  JoinTable,
  BeforeInsert,
  BeforeUpdate,
  DeleteDateColumn,
} from 'typeorm';
import * as bcrypt from 'bcrypt';
import { Order } from 'src/order/order.entity';

const defaultImage =
  'data:image/png;base64,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';
@Entity()
export class User {
  @PrimaryGeneratedColumn()
  id: number;

  @Column({ unique: true })
  username: string;

  @Column({ name: 'first_name' })
  firstName: string;

  @Column({ name: 'last_name' })
  lastName: string;

  @Column({ unique: true })
  email: string;

  @Column()
  password: string;

  @Column({ name: 'date_of_birth' })
  dateOfBirth: Date;

  @OneToMany((type) => Product, (product) => product.user)
  products: Product[];

  @OneToMany((type) => Order, (order) => order.user)
  orders: Order[];

  @OneToMany((type) => Address, (address) => address.user)
  addresses: Address[];

  @Column({ default: defaultImage, name: 'profile_image', type: 'text' })
  profileImage: string;

  @ManyToMany((type) => Role, (role) => role.users)
  @JoinTable({
    name: 'user_role',
    joinColumn: { name: 'user_id', referencedColumnName: 'id' },
    inverseJoinColumn: { name: 'role_id', referencedColumnName: 'id' },
  })
  roles: Role[];

  @CreateDateColumn({ name: 'created_at' })
  createdAt: Date;

  @UpdateDateColumn({ name: 'updated_at' })
  updatedAt: Date;

  @DeleteDateColumn({ name: 'deleted_at' })
  deletedAt: Date;

  @BeforeInsert()
  @BeforeUpdate()
  async hashPassword() {
    const salt = 8;
    if (this.password) this.password = await bcrypt.hash(this.password, salt);
  }

  static relations = ['roles', 'products', 'orders', 'addresses'];

  toResponseObject(): any {
    const obj = {
      id: this.id,
      username: this.username,
      firstName: this.firstName,
      lastName: this.lastName,
      profileImage: this.profileImage,
      updatedAt: this.updatedAt,
      createdAt: this.createdAt,
    };
    if (this.products) {
      obj['products'] = this.products.map((p) => p.toResponseObject());
    }
    if (this.roles) {
      obj['roles'] = this.roles.map((r) => r.toResponseObject());
    }
    if (this.orders) {
      obj['orders'] = this.orders.map((o) => o.toResponseObject());
    }
    if (this.addresses) {
      // Does not work with map for some reason
      obj['addresses'] = this.addresses; //.map((a) => a.toResponseObject());
    }
    return obj;
  }
}
